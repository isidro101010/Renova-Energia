import re
import PyPDF2

def extraer_informacion_pdf(archivo_pdf):
    with open(archivo_pdf, 'rb') as archivo:
        lector = PyPDF2.PdfReader(archivo)
        texto = ""
        for pagina in lector.pages:
            texto += pagina.extract_text()
    
    # Definir patrones para cada categoría
    patrones = {
        "factura": re.search(r"Factura Nro[:\s]+(\d{3}-\d{3}-\d+)", texto),
        "dia": re.search(r"(\d{2})/(\d{2})/(\d{4})", texto),
        "mes": re.search(r"(\d{2})/(\d{2})/(\d{4})", texto),
        "ano": re.search(r"(\d{2})/(\d{2})/(\d{4})", texto),
        "fecha_entrega": re.search(r"Fecha de Entrega[:\s]+([\d/]+)", texto),
        "cliente": re.search(r"Cliente[:\s]+([^\n]+)", texto),
        "ruc": re.search(r"RUC[:\s]+(\d+)", texto),
        "provincia": re.search(r"Provincia[:\s]+([^\n]+)", texto),
        "ciudad": re.search(r"Ciudad[:\s]+([^\n]+)", texto),
        "vendedor": re.search(r"Vendedor[:\s]+([^\n]+)", texto),
        "codigo": re.search(r"Código[:\s]+([^\n]+)", texto),
        "modelo": re.search(r"Modelo[:\s]+([^\n]+)", texto),
        "cantidad": re.search(r"Cantidad[:\s]+(\d+)", texto),
        "costo_unitario": re.search(r"Costo Unitario[:\s]+([\d.,]+)", texto),
        "costo_total": re.search(r"Costo Total[:\s]+([\d.,]+)", texto),
        "iva_pagado": re.search(r"IVA[:\s]+([\d.,]+)", texto),
        "precio_total": re.search(r"Precio Total[:\s]+([\d.,]+)", texto),
        "total_a_facturar": re.search(r"Total[:\s]+([\d.,]+)", texto),
        "condiciones_credito": re.search(r"Condiciones de Crédito[:\s]+([^\n]+)", texto),
    }

    # Extraer y limpiar los resultados
    resultados = {}
    for campo, patron in patrones.items():
        if patron:
            resultados[campo] = patron.group(1)
        else:
            resultados[campo] = "No encontrado"

    return resultados


# Ruta del archivo PDF
archivo_pdf = "Fact 7144 - ANDRADE PAREDES ERICK MICHAEL - equipos varios - JP - 27 12 24.pdf"

# Extraer información
informacion = extraer_informacion_pdf(archivo_pdf)

# Mostrar resultados
print("Información extraída del PDF:")
for campo, valor in informacion.items():
    print(f"{campo.capitalize()}: {valor}")
